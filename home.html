<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Civil Eye Authority ‚Äî Manage & Resolve Issues</title>
    <link rel="shortcut icon" href="../images/logo.jpg" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        :root{--primary:#1e3a8a;--accent:#e91e63;--light:#f0f4f8;--success:#10b981;--warning:#f59e0b;--danger:#ef4444}
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:'Segoe UI',sans-serif;background:#f5f7fa;color:#333}
        
        /* Navbar */
        .navbar{background:#fff;box-shadow:0 2px 8px rgba(0,0,0,0.08);padding:0.75rem 0}
        .navbar-brand{font-weight:800;color:var(--primary);font-size:1.3rem;letter-spacing:1px}
        .nav-link{color:var(--primary);font-weight:500;transition:all 0.3s}
        .nav-link:hover{color:var(--accent);text-decoration:none}
        .btn-outline-cta{border:2px solid var(--accent);color:var(--accent);font-weight:600;border-radius:20px;padding:0.4rem 1.2rem;font-size:0.9rem}
        .btn-outline-cta:hover{background:var(--accent);color:#fff}
        .btn-cta{background:var(--accent);color:#fff;font-weight:600;border-radius:20px;padding:0.5rem 1.3rem;border:none}
        .btn-cta:hover{background:#c2185b;color:#fff}

        /* Info Banner */
        .info-banner{background:var(--primary);color:#fff;padding:0.75rem;font-size:0.9rem;text-align:center}

        /* Dashboard Section */
        .dashboard{padding:2rem 1rem;background:linear-gradient(135deg,#f0f4f8,#fff)}
        .dashboard h1{color:var(--primary);font-weight:900;margin-bottom:2rem}
        
        /* Stat Cards */
        .stat-card{background:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.06);text-align:center;margin-bottom:1.5rem;border-left:4px solid var(--primary)}
        .stat-card.warning{border-left-color:var(--warning)}
        .stat-card.success{border-left-color:var(--success)}
        .stat-card.danger{border-left-color:var(--danger)}
        .stat-number{font-size:2.2rem;font-weight:800;color:var(--primary);margin:0.5rem 0}
        .stat-label{color:#666;font-weight:600;font-size:0.95rem}

        /* Action Cards */
        .action-card{background:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.06);margin-bottom:1.5rem;display:flex;align-items:center;gap:1rem;cursor:pointer;transition:all 0.3s}
        .action-card:hover{transform:translateY(-4px);box-shadow:0 4px 16px rgba(0,0,0,0.12)}
        .action-icon{font-size:2.5rem}
        .action-text h4{color:var(--primary);margin:0;font-weight:700}
        .action-text p{color:#666;margin:0.3rem 0 0 0;font-size:0.9rem}
        .action-arrow{margin-left:auto;color:var(--accent);font-weight:700;font-size:1.3rem}

        /* Complaint Queue */
        .complaint-queue{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px rgba(0,0,0,0.06)}
        .queue-title{color:var(--primary);font-weight:700;margin-bottom:1.5rem}
        .queue-item{padding:1rem;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center}
        .queue-item:last-child{border-bottom:none}
        .queue-priority{display:inline-block;padding:0.3rem 0.8rem;border-radius:20px;font-size:0.85rem;font-weight:600}
        .priority-high{background:#fecaca;color:#991b1b}
        .priority-medium{background:#fde047;color:#713f12}
        .priority-low{background:#d1fae5;color:#065f46}

        /* Features Grid */
        .features{display:grid;grid-template-columns:repeat(3,1fr);gap:1.5rem;margin-top:2rem}
        .feature{background:#fff;padding:2rem 1.5rem;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.06);text-align:center}
        .feature-icon{font-size:2.5rem;margin-bottom:1rem}
        .feature h4{color:var(--primary);margin-bottom:0.5rem;font-weight:700}
        .feature p{color:#666;font-size:0.95rem;line-height:1.5}

        /* Footer */
        footer{background:var(--primary);color:#fff;padding:2rem;text-align:center}

        @media(max-width:768px){
            .stat-card{margin-bottom:1rem}
            .features{grid-template-columns:1fr}
            .action-card{flex-direction:column;text-align:center}
            .action-arrow{margin-left:0;margin-top:0.5rem}
        }
    </style>
</head>
<body>

<!-- Info Banner -->
<div class="info-banner">
  üõ°Ô∏è Authority Dashboard ‚Äî Manage & Resolve Citizen Complaints
</div>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container-fluid px-lg-5">
    <a class="navbar-brand" href="home.html">
      <img src="../images/logo.jpg" alt="logo" width="32" height="32" class="me-2">
      Civil Eye Authority
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navMain">
      <ul class="navbar-nav ms-auto align-items-lg-center gap-3">
        <li class="nav-item"><a class="nav-link" href="home.html">Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" href="viewcomplaint.html">Queue</a></li>
        <li class="nav-item"><a class="nav-link" href="adddept.html">Departments</a></li>
        <li class="nav-item"><a class="btn btn-outline-cta" href="../signin.html">Sign Out</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- Dashboard -->
<main class="dashboard">
  <div class="container-xl">
    <h1>üëã Welcome Back, Officer</h1>
    
    <!-- Statistics -->
    <div class="row">
      <div class="col-md-3">
        <div class="stat-card">
          <div class="stat-label">Total Complaints</div>
          <div class="stat-number">47</div>
          <small style="color:#999">This month</small>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stat-card warning">
          <div class="stat-label">Pending Review</div>
          <div class="stat-number" style="color:var(--warning)">12</div>
          <small style="color:#999">Awaiting action</small>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stat-card">
          <div class="stat-label">In Progress</div>
          <div class="stat-number" style="color:var(--accent)">18</div>
          <small style="color:#999">Being resolved</small>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stat-card success">
          <div class="stat-label">Resolved</div>
          <div class="stat-number" style="color:var(--success)">17</div>
          <small style="color:#999">Closed cases</small>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <h2 style="color:var(--primary);margin-top:2.5rem;margin-bottom:1.5rem;font-weight:800">Quick Actions</h2>
    <div class="row">
      <div class="col-md-4">
        <div class="action-card" onclick="location.href='viewcomplaint.html'">
          <div class="action-icon">üìã</div>
          <div class="action-text">
            <h4>Review Queue</h4>
            <p>Check pending complaints requiring action</p>
          </div>
          <div class="action-arrow">‚Üí</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="action-card" onclick="location.href='adddept.html'">
          <div class="action-icon">üè¢</div>
          <div class="action-text">
            <h4>Manage Departments</h4>
            <p>View and manage department assignments</p>
          </div>
          <div class="action-arrow">‚Üí</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="action-card">
          <div class="action-icon">üìä</div>
          <div class="action-text">
            <h4>View Reports</h4>
            <p>Generate performance and analytics reports</p>
          </div>
          <div class="action-arrow">‚Üí</div>
        </div>
      </div>
    </div>

    <!-- Complaint Queue Preview -->
    <h2 style="color:var(--primary);margin-top:2.5rem;margin-bottom:1.5rem;font-weight:800">Latest Complaints</h2>
    <div class="complaint-queue">
      <div id="complaintQueueContainer">
        <div style="text-align:center;padding:2rem;color:#999">
          <p>Loading complaints...</p>
        </div>
      </div>
    </div>

    <!-- Features -->
    <h2 style="color:var(--primary);margin-top:2.5rem;margin-bottom:1.5rem;font-weight:800">Authority Capabilities</h2>
    <div class="features">
      <div class="feature">
        <div class="feature-icon">‚ö°</div>
        <h4>Quick Response</h4>
        <p>Review and prioritize complaints with real-time priority assignment.</p>
      </div>
      <div class="feature">
        <div class="feature-icon">üìç</div>
        <h4>Location Tracking</h4>
        <p>View complaint locations and dispatch resources efficiently.</p>
      </div>
      <div class="feature">
        <div class="feature-icon">üì¢</div>
        <h4>Update Citizens</h4>
        <p>Send real-time status updates to citizens throughout resolution process.</p>
      </div>
    </div>
  </div>
</main>

<footer>
  <div class="container">
    <small>¬© <span id="year"></span> Civil Eye ‚Äî Empowering authorities to serve better.</small>
  </div>
</footer>

<script>
// Fetch complaint data from backend
async function loadComplaints() {
  try {
    // Replace with your backend API endpoint
    const response = await fetch('/api/complaints/latest');
    const complaints = await response.json();
    renderComplaints(complaints);
  } catch (error) {
    console.log('Backend not available, using sample data');
    // Fallback to sample data if backend is unavailable
    renderComplaints(sampleComplaints);
  }
}

// Sample data for demonstration
const sampleComplaints = [
  {
    id: 'CE-2024-047',
    type: 'Road Damage',
    location: 'Main Street',
    priority: 'high',
    timeAgo: '2 hours ago',
    status: 'pending'
  },
  {
    id: 'CE-2024-046',
    type: 'Public Safety',
    location: 'Downtown Market',
    priority: 'high',
    timeAgo: '4 hours ago',
    status: 'pending'
  },
  {
    id: 'CE-2024-045',
    type: 'Water Supply',
    location: 'Park Avenue',
    priority: 'medium',
    timeAgo: '6 hours ago',
    status: 'inprogress'
  }
];

// Render complaints dynamically
function renderComplaints(complaints) {
  const container = document.getElementById('complaintQueueContainer');
  
  if (!complaints || complaints.length === 0) {
    container.innerHTML = '<div style="text-align:center;padding:2rem;color:#999"><p>No pending complaints</p></div>';
    return;
  }

  container.innerHTML = complaints.map(complaint => {
    const priorityClass = `priority-${complaint.priority}`;
    return `
      <div class="queue-item">
        <div>
          <strong style="color:var(--primary)">#${complaint.id}</strong>
          <span class="queue-priority ${priorityClass}">${complaint.priority.charAt(0).toUpperCase() + complaint.priority.slice(1)}</span>
          <p style="margin:0.3rem 0 0 0;color:#666;font-size:0.9rem">${complaint.type} ‚Äî ${complaint.location} (${complaint.timeAgo})</p>
        </div>
        <a href="viewcomplaint.html?id=${complaint.id}" class="btn" style="background:var(--primary);color:#fff;padding:0.4rem 1rem;font-size:0.85rem;border-radius:8px;text-decoration:none">Review</a>
      </div>
    `;
  }).join('');
}

// Load complaints on page load
document.addEventListener('DOMContentLoaded', loadComplaints);

document.getElementById('year').textContent=new Date().getFullYear();
</script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
</body>
</html>